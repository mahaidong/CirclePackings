%--------------------------------------------------------------------------------------------------
% 2020/08/29 Brice Loustau's custom package. 
% This file 'bricebase.sty' is to be included in the packages 'bricedocument.sty' or 'briceslides.sty'
%--------------------------------------------------------------------------------------------------


\pdfoutput=1 % Process with pdflatex


%--------------------------------------------------------------------------------------------------
% Including packages
%--------------------------------------------------------------------------------------------------

% Remark: At this point, the package hyperref has already been included from bricedocument.sty


% ---------- Latex housekeeping ----------
\RequirePackage[l2tabu, orthodox]{nag} % Produces a warning when using a deprecated command or package
\RequirePackage{silence}\WarningFilter{remreset}{The remreset package} % In order to avoid getting a warning produced by thmtools

% ---------- Text and font (and amsmath) ----------
\RequirePackage[T1]{fontenc}
\RequirePackage[utf8]{inputenc}
\RequirePackageWithOptions{babel}
\RequirePackage[stretch=10, tracking=alltext, letterspace=-7]{microtype} % Better stretching/shrinking of text https://tex.stackexchange.com/questions/553/what-packages-do-people-load-by-default-in-latex?noredirect=1&lq=1
\RequirePackage{lmodern} % Slight improvement of CM
% \RequirePackage{newtxtext,newtxmath} % A good Times font
\RequirePackage{amsmath,amssymb,amsfonts, amsthm} % Has to be included before libertine
\RequirePackage{libertine} % Libertine (a bit more fancy)
\RequirePackage[libertine]{newtxmath} % Libertine (a bit more fancy)
\RequirePackage[scaled=0.85]{beramono} % For mono font
% \urlstyle{rm} % For using regular font for URLs
\overfullrule=1mm %Show overfull boxes

% ---------- General editing ----------
\RequirePackage{tabularx} \newcolumntype{L}{>{\raggedright\arraybackslash}X} 
% e.g. \begin{tabularx}{\linewidth}{l L} Allows multiple lines in the cells of the second column.
% \RequirePackage{bbm} % To be able to use \mathbbm{1} (e.g. for characteristic function of a set)
\RequirePackage{caption} % For getting rid of colon in the caption of figures with empty caption
\RequirePackage{tikz, tikz-cd}
\RequirePackage[shortlabels]{enumitem} % To be able to use options of enumerate such as \begin{enumerate}[(i)]
\RequirePackage{graphicx}
\RequirePackage{subcaption} % For subfigures
\RequirePackage{xspace} % to define macros \ie and \eg, cf below

% ---------- Math ----------
\RequirePackage{mathtools} % Allows to use \mathtoolsset{showonlyrefs=true} to only number equations that are referenced to (using eqref).
\RequirePackage{thmtools, thm-restate} % Great for theorem environments. For example useful to reference theorems, restate theorems. See documentation.



%--------------------------------------------------------------------------------------------------
% Passing options
%--------------------------------------------------------------------------------------------------
\DeclareOption{english}{%
   \PassOptionsToPackage{english}{babel}}
\DeclareOption{french}{%
   \PassOptionsToPackage{french}{babel}}
\ProcessOptions\relax

%--------------------------------------------------------------------------------------------------
% Lists
%--------------------------------------------------------------------------------------------------
\setlist{nolistsep}


%--------------------------------------------------------------------------------------------------
% Equation numbering
%--------------------------------------------------------------------------------------------------
% \numberwithin{equation}{section}
% \renewcommand{\theequation}{\arabic{equation}} % Prevents equations from being numbered within sections, but for some reason it seems to not be needed.
\mathtoolsset{showonlyrefs=true} % Only number equations that are referenced to (using eqref). This relies on the mathtools package.


%--------------------------------------------------------------------------------------------------
% Hyperref customization
%--------------------------------------------------------------------------------------------------

% See http://latexcolor.com/ for a nice list of colors
\definecolor{uared}{rgb}{0.85, 0.0, 0.3}
\definecolor{debianred}{rgb}{0.84, 0.04, 0.33}
\definecolor{cadmiumred}{rgb}{0.89, 0.0, 0.13}
\definecolor{candyapplered}{rgb}{1.0, 0.03, 0.0}

\definecolor{tropicalrainforest}{rgb}{0.0, 0.46, 0.37}
\definecolor{pakistangreen}{rgb}{0.0, 0.4, 0.0}

\definecolor{bleudefrance}{rgb}{0.19, 0.55, 0.91}
\definecolor{brandeisblue}{rgb}{0.0, 0.44, 1.0}
\definecolor{mediumblue}{rgb}{0.0, 0.0, 0.8}

\hypersetup{
%     linktocpage,    % makes links only for page numbers in the table of contents
    bookmarksnumbered,
    unicode=false,          % non-Latin characters in Acrobat’s bookmarks
    pdftoolbar=true,        % show Acrobat’s toolbar?
    pdfmenubar=true,        % show Acrobat’s menu?
    pdffitwindow=false,     % window fit to page when opened
    pdfstartview={FitH},    % fits the width of the page to the window
    pdftitle={Title},    % title
    pdfauthor={Author},     % author
    pdfsubject={Subject},   % subject of the document
    pdfkeywords={key1} {key2} {key3}, % list of keywords
    breaklinks = true, % allows URLs to be broken over multiple lines
    pdfnewwindow=true,      % links in new PDF window
    colorlinks=true,       % false: boxed links; true: colored links
    linkcolor=mediumblue,          % color of internal links (change box color with linkbordercolor)
    citecolor=candyapplered,        % color of links to bibliography
    filecolor=magenta,      % color of file links
    urlcolor=blue          % color of external links
}

% Section symbol: when calling \autoref{subsec:whatever}, it will produce § 1.3 instead of subsection 1.3.
\addto\extrasenglish{
  \def\sectionautorefname{\S}
  \def\subsectionautorefname{\S}
  \def\subsubsectionautorefname{\S}
}
\addto\extrasfrench{
  \def\subsectionautorefname{\S}
  \def\subsubsectionautorefname{\S}
}

% Capitalize the autoref to chapters
\addto\extrasenglish{  
  \def\chapterautorefname{Chapter}  
}


%--------------------------------------------------------------------------------------------------
% Text macros
%--------------------------------------------------------------------------------------------------

 % French quotation marks (guillemets français « et »)
\newcommand{\guill}[1]{\og #1 \fg{}}


% i.e., e.g., etc. [USAGE: \ie{} \eg{} \etc{}]
\newcommand*{\ie}{i.e.\@\xspace}
\makeatletter
\newcommand*{\eg}{%
    \@ifnextchar{.}%
        {e.g.}%
        {e.g.\@\xspace}%
}
\newcommand*{\etc}{%
    \@ifnextchar{.}%
        {etc}%
        {etc.\@\xspace}%
}
\makeatother



%--------------------------------------------------------------------------------------------------
% Math macros
%--------------------------------------------------------------------------------------------------

% \newcommand{\bA}{\mathbb{A}} etc.
\makeatletter
\@tempcnta=\@ne
\def\@nameedef#1{\expandafter\edef\csname #1\endcsname}
\loop\ifnum\@tempcnta<27
  \@nameedef{b\@Alph\@tempcnta}{\noexpand\mathbb{\@Alph\@tempcnta}}
  \advance\@tempcnta\@ne
\repeat

% \newcommand{\cA}{\mathcal{A}} etc.
\makeatletter
\@tempcnta=\@ne
\def\@nameedef#1{\expandafter\edef\csname #1\endcsname}
\loop\ifnum\@tempcnta<27
  \@nameedef{c\@Alph\@tempcnta}{\noexpand\mathcal{\@Alph\@tempcnta}}
  \advance\@tempcnta\@ne
\repeat

% \newcommand{\tA}{\textup{A}} etc.
\makeatletter
\@tempcnta=\@ne
\def\@nameedef#1{\expandafter\edef\csname #1\endcsname}
\loop\ifnum\@tempcnta<27
  \@nameedef{t\@Alph\@tempcnta}{\noexpand\textup{\@Alph\@tempcnta}}
  \advance\@tempcnta\@ne
\repeat

% Most frequent mathbb
\newcommand{\C}{\mathbb{C}}
\newcommand{\CP}{\mathbb{C}P}
\newcommand{\D}{\mathbb{D}}
\renewcommand{\H}{\mathbb{H}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Z}{\mathbb{Z}}


% Moduli spaces
\newcommand{\CPS}{\mathcal{CP}(S)}
\newcommand{\TS}{\mathcal{T}(S)}
\newcommand{\FS}{\mathcal{F}(S)}
\newcommand{\QFS}{\mathcal{QF}(S)}
\newcommand{\AFS}{\mathcal{AF}(S)}
\newcommand{\XS}{\mathcal{X}(S)}


% Math operators
\newcommand{\DeclareMyOperator}[1]{% shortcut, cf https://tex.stackexchange.com/questions/48/
  \expandafter\DeclareMathOperator\csname #1\endcsname{#1}
}
\newcommand{\DeclareMathOperators}{\forcsvlist{\DeclareMyOperator}}
\DeclareMathOperators{ad, Ad, Aff, arcosh, arccot, arcoth, arsinh, artanh, Area, Arg, argmin, Aut, CAT, codim, csch, Dev, diam, Diff, dvol, End, grad, GL, Hess, Hom, Homeo, id, Id, Ind, inj, Isom, Lie, Log, Map, Mod, Out, PGL, PO, PSL, PSO, PSp, PSU, PU, pv, Ric, Riem, rk, sech, sinhc, SO, SL, Sp, Spec, Spin, SU, supp, Sym, tr, U, vol, Vol, radius, thick}
\renewcommand{\O}{\operatorname{O}}
\DeclareMathOperator{\Real}{Re}
\DeclareMathOperator{\Imag}{Im}
\DeclareMathOperator{\I}{I}
\DeclareMathOperator{\II}{I\!I}
% \DeclareMathOperator{\Mob}{M\ddot{o}b} %The trema does not seem to work with newtxmath
\newcommand{\Mob}{\textup{M\"ob}}



% Derivatives and differentials
\newcommand{\upd}{\mathop{}\!\mathrm{d}} % For derivatives and differentials
\newcommand{\updc}{\mathop{}\!\mathrm{d}^{\mathrm{c}}\!} % For the differential d^c (complex geometry)
\newcommand{\upD}{\mathop{}\!\mathrm{D}}
\newcommand{\dd}[1]{\dfrac{\partial}{\partial #1}}
\newcommand{\ddt}{\dfrac{\upd}{\upd t}}
\newcommand{\dz}{\upd z}
\newcommand{\dzbar}{\upd \bar{z}}
\newcommand{\du}{\upd u}
\newcommand{\dubar}{\upd \bar{u}}
\newcommand{\dw}{\upd w}
\newcommand{\dwbar}{\upd \bar{w}}
\newcommand{\del}{\partial}
\newcommand{\delbar}{\bar{\partial}}


% Arrows
% \newcommand{\isoto}{\xrightarrow{\sim}}
\newcommand{\isoto}{\xrightarrow{\raisebox{-0.7ex}[0ex][0ex]{$\sim$}}}

% Upright letters
\DeclareMathOperator{\upL}{L}
\DeclareMathOperator{\ubP}{\mathbf{P}}
\DeclareMathOperator{\upP}{P}
\DeclareMathOperator{\upT}{T}
\DeclareMathOperator{\upW}{W}

% Big O and little o
\newcommand{\bigO}{O}
\newcommand{\littleo}{o}

% Matrices
\newcommand{\transpose}[1]{{}^t\!{#1}}

% Analysis
\newcommand\evalat[1]{_{\lvert #1}} % For the pipe in df|x

% Algebra
\newcommand{\bigslant}[2]{{\raisebox{.2em}{$#1$}\left/\raisebox{-.2em}{$#2$}\right.}} % Typeset quotients A/B
\newcommand{\bigslantleft}[2]{{\raisebox{-.2em}{$#1$}\left\backslash \raisebox{.2em}{$#2$}\right.}} % Typeset quotients A\B
\DeclarePairedDelimiter\doubleslash{/\!/}{}
\newcommand{\bigdoubleslant}[2]{{\raisebox{.2em}{$#1$}\doubleslash{\raisebox{-.2em}{$#2$}}{}}} % Typeset quotients A//B

% \bigcdot
\makeatletter
\newcommand*\bigcdot{\mathpalette\bigcdot@{.5}}
\newcommand*\bigcdot@[2]{\mathbin{\vcenter{\hbox{\scalebox{#2}{$\m@th#1\bullet$}}}}}
\makeatother

% Computer science
\newcommand{\Cpp}{C\texttt{++}}
